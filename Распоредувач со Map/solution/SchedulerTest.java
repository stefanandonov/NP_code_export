import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.Scanner;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.TreeMap;

class Scheduler <T> {
	
	private TreeMap<Date,T> timestamps;
	
	public Scheduler() {
		timestamps = new TreeMap<Date,T>();
	}
	
	public void add( Date d , T t ) {
		timestamps.put(d,t);
	}
	
	public void remove(Date d) {
		timestamps.remove(d);
	}
	
	public T next() {
		return timestamps.higherEntry(new Date()).getValue();
	}
	
	public T last() {
		return timestamps.floorEntry(new Date()).getValue();
	}
	
	public ArrayList<T> getAll(Date begin,Date end) {
		return new ArrayList<T>(timestamps.subMap(begin, end).values());
	}
	
	public T getFirst () {
		return timestamps.firstEntry().getValue();
	}
	
	public T getLast () {
		return timestamps.lastEntry().getValue();
	}
	
}



/**

	 Test cases:
	 
	 0 whatever whatever first whatever whatever whatever last
	 
	 3 before_inside last before_outside after_inside1 after_inside2 next after_outside
	 
	 4
	 873961200000 1 
	 875649600000 2 
	 875955600000 3 
	 876042000000 4 
	 876146400000 5 
	 877068000000 6 
 	 878940000000 7 
	 881013600000 8 
	 881802000000 9 
	 891928800000 10 
	 query
	 867482800000 1744289600000
	 879722800000 1752688400000



	4
	864007200000 1 
	864028800000 2 
	864068400000 3 
	864118800000 4 
	864223200000 5 
	864262800000 6 
	864273600000 7 
	864338400000 8 
	864342000000 9 
	864378000000 10 
	864381600000 11 
	864446400000 12 
	864464400000 13 
	864514800000 14 
	864525600000 15 
	864532800000 16 
	864540000000 17 
	864554400000 18 
	864572400000 19 
	864604800000 20 
	864637200000 21 
	864648000000 22 
	864655200000 23 
	864702000000 24 
	864781200000 25 
	864824400000 26 
	864853200000 27 
	864882000000 28 
	864914400000 29 
	864972000000 30 
	865008000000 31 
	865011600000 32 
	865062000000 33 
	865090800000 34 
	865112400000 35 
	865184400000 36 
	865231200000 37 
	865292400000 38 
	865360800000 39 
	865375200000 40 
	865393200000 41 
	865422000000 42 
	865440000000 43 
	865515600000 44 
	865551600000 45 
	865555200000 46 
	865566000000 47 
	865573200000 48 
	865580400000 49 
	865594800000 50 
	865605600000 51 
	865666800000 52 
	865674000000 53 
	865688400000 54 
	865702800000 55 
	865713600000 56 
	865756800000 57 
	865778400000 58 
	865818000000 59 
	865836000000 60 
	865846800000 61 
	865868400000 62 
	865875600000 63 
	865918800000 64 
	865922400000 65 
	865965600000 66 
	866109600000 67 
	866127600000 68 
	866131200000 69 
	866163600000 70 
	866170800000 71 
	866188800000 72 
	866214000000 73 
	866289600000 74 
	866343600000 75 
	866354400000 76 
	866383200000 77 
	866426400000 78 
	866430000000 79 
	866502000000 80 
	866541600000 81 
	866545200000 82 
	866559600000 83 
	866577600000 84 
	866599200000 85 
	866667600000 86 
	866689200000 87 
	866692800000 88 
	866700000000 89 
	866808000000 90 
	866811600000 91 
	866815200000 92 
	866822400000 93 
	866901600000 94 
	866973600000 95 
	866991600000 96 
	867042000000 97 
	867074400000 98 
	867096000000 99 
	867110400000 100 
	867150000000 101 
	867164400000 102 
	867189600000 103 
	867196800000 104 
	867229200000 105 
	867344400000 106 
	867380400000 107 
	867466800000 108 
	867567600000 109 
	867600000000 110 
	867632400000 111 
	867715200000 112 
	867747600000 113 
	867794400000 114 
	867812400000 115 
	867816000000 116 
	867837600000 117 
	867848400000 118 
	867852000000 119 
	867952800000 120 
	867967200000 121 
	868014000000 122 
	868032000000 123 
	868064400000 124 
	868075200000 125 
	868096800000 126 
	868161600000 127 
	868276800000 128 
	868298400000 129 
	868374000000 130 
	868424400000 131 
	868428000000 132 
	868456800000 133 
	868482000000 134 
	868518000000 135 
	868582800000 136 
	868586400000 137 
	868618800000 138 
	868658400000 139 
	868716000000 140 
	868928400000 141 
	868978800000 142 
	868982400000 143 
	869000400000 144 
	869004000000 145 
	869090400000 146 
	869097600000 147 
	869104800000 148 
	869137200000 149 
	869202000000 150 
	869245200000 151 
	869263200000 152 
	869266800000 153 
	869288400000 154 
	869324400000 155 
	869346000000 156 
	869349600000 157 
	869364000000 158 
	869374800000 159 
	869403600000 160 
	869464800000 161 
	869475600000 162 
	869515200000 163 
	869547600000 164 
	869558400000 165 
	869562000000 166 
	869572800000 167 
	869598000000 168 
	869652000000 169 
	869666400000 170 
	869695200000 171 
	869698800000 172 
	869727600000 173 
	869767200000 174 
	869814000000 175 
	869824800000 176 
	869850000000 177 
	869853600000 178 
	869868000000 179 
	869889600000 180 
	869896800000 181 
	869907600000 182 
	869922000000 183 
	869936400000 184 
	870026400000 185 
	870051600000 186 
	870069600000 187 
	870098400000 188 
	870116400000 189 
	870141600000 190 
	870177600000 191 
	870202800000 192 
	870213600000 193 
	870343200000 194 
	870346800000 195 
	870350400000 196 
	870368400000 197 
	870375600000 198 
	870390000000 199 
	870415200000 200 
	870418800000 201 
	870451200000 202 
	870465600000 203 
	870472800000 204 
	870595200000 205 
	870602400000 206 
	870613200000 207 
	870616800000 208 
	870703200000 209 
	870732000000 210 
	870825600000 211 
	870897600000 212 
	870926400000 213 
	870930000000 214 
	870944400000 215 
	870951600000 216 
	870976800000 217 
	870991200000 218 
	871059600000 219 
	871074000000 220 
	871117200000 221 
	871124400000 222 
	871182000000 223 
	871210800000 224 
	871225200000 225 
	871401600000 226 
	871448400000 227 
	871452000000 228 
	871455600000 229 
	871466400000 230 
	871480800000 231 
	871509600000 232 
	871516800000 233 
	871542000000 234 
	871549200000 235 
	871560000000 236 
	871570800000 237 
	871653600000 238 
	871664400000 239 
	871689600000 240 
	871714800000 241 
	871743600000 242 
	871758000000 243 
	871772400000 244 
	871815600000 245 
	871830000000 246 
	871862400000 247 
	871869600000 248 
	871902000000 249 
	871970400000 250 
	871981200000 251 
	871999200000 252 
	872020800000 253 
	872085600000 254 
	872128800000 255 
	872132400000 256 
	872168400000 257 
	872233200000 258 
	872262000000 259 
	872323200000 260 
	872337600000 261 
	872348400000 262 
	872380800000 263 
	872388000000 264 
	872398800000 265 
	872442000000 266 
	872470800000 267 
	872474400000 268 
	872485200000 269 
	872496000000 270 
	872542800000 271 
	872553600000 272 
	872564400000 273 
	872578800000 274 
	872668800000 275 
	872676000000 276 
	872766000000 277 
	872787600000 278 
	872852400000 279 
	872974800000 280 
	872989200000 281 
	873043200000 282 
	873097200000 283 
	873104400000 284 
	873115200000 285 
	873248400000 286 
	873262800000 287 
	873270000000 288 
	873273600000 289 
	873316800000 290 
	873370800000 291 
	873450000000 292 
	873457200000 293 
	873464400000 294 
	873540000000 295 
	873561600000 296 
	873572400000 297 
	873630000000 298 
	873648000000 299 
	873662400000 300 
	873694800000 301 
	873799200000 302 
	873810000000 303 
	873813600000 304 
	873838800000 305 
	873849600000 306 
	873896400000 307 
	873950400000 308 
	873968400000 309 
	874022400000 310 
	874026000000 311 
	874083600000 312 
	874090800000 313 
	874098000000 314 
	874126800000 315 
	874188000000 316 
	874238400000 317 
	874486800000 318 
	874512000000 319 
	874548000000 320 
	874555200000 321 
	874566000000 322 
	874569600000 323 
	874587600000 324 
	874605600000 325 
	874612800000 326 
	874627200000 327 
	874663200000 328 
	874717200000 329 
	874720800000 330 
	874753200000 331 
	874767600000 332 
	874818000000 333 
	874836000000 334 
	874904400000 335 
	874933200000 336 
	874976400000 337 
	875012400000 338 
	875167200000 339 
	875185200000 340 
	875214000000 341 
	875232000000 342 
	875275200000 343 
	875282400000 344 
	875347200000 345 
	875358000000 346 
	875383200000 347 
	875433600000 348 
	875509200000 349 
	875520000000 350 
	875545200000 351 
	875548800000 352 
	875667600000 353 
	875678400000 354 
	875714400000 355 
	875718000000 356 
	875754000000 357 
	875761200000 358 
	875808000000 359 
	875833200000 360 
	875854800000 361 
	875883600000 362 
	875926800000 363 
	875937600000 364 
	875952000000 365 
	875991600000 366 
	876009600000 367 
	876142800000 368 
	876175200000 369 
	876204000000 370 
	876207600000 371 
	876229200000 372 
	876236400000 373 
	876272400000 374 
	876344400000 375 
	876348000000 376 
	876376800000 377 
	876391200000 378 
	876423600000 379 
	876502800000 380 
	876513600000 381 
	876517200000 382 
	876578400000 383 
	876589200000 384 
	876607200000 385 
	876621600000 386 
	876646800000 387 
	876657600000 388 
	876664800000 389 
	876682800000 390 
	876726000000 391 
	876780000000 392 
	876805200000 393 
	876841200000 394 
	876920400000 395 
	876927600000 396 
	876934800000 397 
	876938400000 398 
	876960000000 399 
	876970800000 400 
	876992400000 401 
	877006800000 402 
	877078800000 403 
	877104000000 404 
	877154400000 405 
	877161600000 406 
	877230000000 407 
	877237200000 408 
	877294800000 409 
	877334400000 410 
	877374000000 411 
	877420800000 412 
	877428000000 413 
	877496400000 414 
	877507200000 415 
	877543200000 416 
	877557600000 417 
	877593600000 418 
	877683600000 419 
	877698000000 420 
	877701600000 421 
	877741200000 422 
	877784400000 423 
	877806000000 424 
	877816800000 425 
	877842000000 426 
	877860000000 427 
	877881600000 428 
	877921200000 429 
	878000400000 430 
	878011200000 431 
	878054400000 432 
	878068800000 433 
	878133600000 434 
	878140800000 435 
	878151600000 436 
	878173200000 437 
	878176800000 438 
	878230800000 439 
	878259600000 440 
	878295600000 441 
	878310000000 442 
	878450400000 443 
	878464800000 444 
	878490000000 445 
	878536800000 446 
	878558400000 447 
	878576400000 448 
	878612400000 449 
	878634000000 450 
	878673600000 451 
	878695200000 452 
	878799600000 453 
	878803200000 454 
	878817600000 455 
	878821200000 456 
	878824800000 457 
	878832000000 458 
	878835600000 459 
	878853600000 460 
	878864400000 461 
	878868000000 462 
	878893200000 463 
	878911200000 464 
	878961600000 465 
	878965200000 466 
	878968800000 467 
	879015600000 468 
	879030000000 469 
	879048000000 470 
	879055200000 471 
	879058800000 472 
	879094800000 473 
	879098400000 474 
	879102000000 475 
	879105600000 476 
	879109200000 477 
	879112800000 478 
	879123600000 479 
	879138000000 480 
	879152400000 481 
	879253200000 482 
	879267600000 483 
	879375600000 484 
	879382800000 485 
	879444000000 486 
	879458400000 487 
	879487200000 488 
	879490800000 489 
	879516000000 490 
	879570000000 491 
	879577200000 492 
	879631200000 493 
	879670800000 494 
	879678000000 495 
	879771600000 496 
	879789600000 497 
	879800400000 498 
	879822000000 499 
	879847200000 500 
	879850800000 501 
	879886800000 502 
	879904800000 503 
	879919200000 504 
	879930000000 505 
	879933600000 506 
	879940800000 507 
	879962400000 508 
	879998400000 509 
	880034400000 510 
	880045200000 511 
	880113600000 512 
	880164000000 513 
	880210800000 514 
	880246800000 515 
	880272000000 516 
	880318800000 517 
	880416000000 518 
	880455600000 519 
	880462800000 520 
	880473600000 521 
	880491600000 522 
	880538400000 523 
	880545600000 524 
	880560000000 525 
	880567200000 526 
	880585200000 527 
	880621200000 528 
	880635600000 529 
	880657200000 530 
	880671600000 531 
	880682400000 532 
	880686000000 533 
	880689600000 534 
	880693200000 535 
	880704000000 536 
	880776000000 537 
	880790400000 538 
	880815600000 539 
	880819200000 540 
	880876800000 541 
	880891200000 542 
	880905600000 543 
	880999200000 544 
	881024400000 545 
	881038800000 546 
	881060400000 547 
	881143200000 548 
	881269200000 549 
	881301600000 550 
	881395200000 551 
	881445600000 552 
	881546400000 553 
	881622000000 554 
	881629200000 555 
	881719200000 556 
	881798400000 557 
	881830800000 558 
	881834400000 559 
	881881200000 560 
	881913600000 561 
	881938800000 562 
	881971200000 563 
	882014400000 564 
	882025200000 565 
	882057600000 566 
	882075600000 567 
	882093600000 568 
	882100800000 569 
	882126000000 570 
	882136800000 571 
	882140400000 572 
	882158400000 573 
	882248400000 574 
	882255600000 575 
	882262800000 576 
	882288000000 577 
	882320400000 578 
	882345600000 579 
	882388800000 580 
	882410400000 581 
	882446400000 582 
	882500400000 583 
	882543600000 584 
	882554400000 585 
	882619200000 586 
	882648000000 587 
	882651600000 588 
	882709200000 589 
	882727200000 590 
	882745200000 591 
	882777600000 592 
	882936000000 593 
	882946800000 594 
	882982800000 595 
	883015200000 596 
	883026000000 597 
	883108800000 598 
	883123200000 599 
	883162800000 600 
	883170000000 601 
	883202400000 602 
	883231200000 603 
	883267200000 604 
	883270800000 605 
	883274400000 606 
	883324800000 607 
	883350000000 608 
	883371600000 609 
	883450800000 610 
	883479600000 611 
	883526400000 612 
	883576800000 613 
	883594800000 614 
	883630800000 615 
	883702800000 616 
	883706400000 617 
	883767600000 618 
	883821600000 619 
	883861200000 620 
	883868400000 621 
	883954800000 622 
	883965600000 623 
	884037600000 624 
	884098800000 625 
	884210400000 626 
	884217600000 627 
	884224800000 628 
	884232000000 629 
	884372400000 630 
	884390400000 631 
	884394000000 632 
	884412000000 633 
	884415600000 634 
	884509200000 635 
	884548800000 636 
	884559600000 637 
	884584800000 638 
	884638800000 639 
	884732400000 640 
	884736000000 641 
	884779200000 642 
	884790000000 643 
	884800800000 644 
	884808000000 645 
	884818800000 646 
	884890800000 647 
	884905200000 648 
	884937600000 649 
	884948400000 650 
	884995200000 651 
	885020400000 652 
	885027600000 653 
	885045600000 654 
	885052800000 655 
	885078000000 656 
	885099600000 657 
	885110400000 658 
	885211200000 659 
	885240000000 660 
	885247200000 661 
	885250800000 662 
	885276000000 663 
	885297600000 664 
	885322800000 665 
	885340800000 666 
	885351600000 667 
	885358800000 668 
	885366000000 669 
	885387600000 670 
	885456000000 671 
	885492000000 672 
	885560400000 673 
	885697200000 674 
	885733200000 675 
	885747600000 676 
	885765600000 677 
	885801600000 678 
	885848400000 679 
	885852000000 680 
	885906000000 681 
	885909600000 682 
	886021200000 683 
	886035600000 684 
	886057200000 685 
	886089600000 686 
	886111200000 687 
	886125600000 688 
	886183200000 689 
	886201200000 690 
	886237200000 691 
	886312800000 692 
	886420800000 693 
	886435200000 694 
	886467600000 695 
	886485600000 696 
	886492800000 697 
	886503600000 698 
	886510800000 699 
	886532400000 700 
	886550400000 701 
	886582800000 702 
	886586400000 703 
	886611600000 704 
	886719600000 705 
	886737600000 706 
	886744800000 707 
	886773600000 708 
	886946400000 709 
	887022000000 710 
	887050800000 711 
	887101200000 712 
	887148000000 713 
	887173200000 714 
	887202000000 715 
	887223600000 716 
	887241600000 717 
	887248800000 718 
	887263200000 719 
	887302800000 720 
	887338800000 721 
	887389200000 722 
	887400000000 723 
	887572800000 724 
	887598000000 725 
	887626800000 726 
	887630400000 727 
	887695200000 728 
	887709600000 729 
	887720400000 730 
	887763600000 731 
	887774400000 732 
	887785200000 733 
	887799600000 734 
	887810400000 735 
	887835600000 736 
	887839200000 737 
	887850000000 738 
	887875200000 739 
	887878800000 740 
	887929200000 741 
	887990400000 742 
	888033600000 743 
	888062400000 744 
	888080400000 745 
	888120000000 746 
	888152400000 747 
	888174000000 748 
	888195600000 749 
	888224400000 750 
	888238800000 751 
	888246000000 752 
	888260400000 753 
	888336000000 754 
	888343200000 755 
	888368400000 756 
	888390000000 757 
	888411600000 758 
	888469200000 759 
	888598800000 760 
	888609600000 761 
	888660000000 762 
	888746400000 763 
	888750000000 764 
	888825600000 765 
	888854400000 766 
	888865200000 767 
	888872400000 768 
	888876000000 769 
	888886800000 770 
	888912000000 771 
	888951600000 772 
	889045200000 773 
	889113600000 774 
	889146000000 775 
	889214400000 776 
	889243200000 777 
	889344000000 778 
	889383600000 779 
	889387200000 780 
	889390800000 781 
	889426800000 782 
	889513200000 783 
	889560000000 784 
	889585200000 785 
	889603200000 786 
	889657200000 787 
	889671600000 788 
	889707600000 789 
	889711200000 790 
	889722000000 791 
	889747200000 792 
	889804800000 793 
	889945200000 794 
	889984800000 795 
	890024400000 796 
	890150400000 797 
	890164800000 798 
	890186400000 799 
	890190000000 800 
	890215200000 801 
	890229600000 802 
	890370000000 803 
	890456400000 804 
	890470800000 805 
	890478000000 806 
	890517600000 807 
	890550000000 808 
	890614800000 809 
	890704800000 810 
	890758800000 811 
	890787600000 812 
	890798400000 813 
	890856000000 814 
	890910000000 815 
	890924400000 816 
	890928000000 817 
	890949600000 818 
	890956800000 819 
	891054000000 820 
	891147600000 821 
	891151200000 822 
	891162000000 823 
	891165600000 824 
	891216000000 825 
	891237600000 826 
	891244800000 827 
	891298800000 828 
	891338400000 829 
	891370800000 830 
	891450000000 831 
	891489600000 832 
	891547200000 833 
	891590400000 834 
	891601200000 835 
	891619200000 836 
	891676800000 837 
	891687600000 838 
	891752400000 839 
	891770400000 840 
	891810000000 841 
	891820800000 842 
	891864000000 843 
	891874800000 844 
	891903600000 845 
	891943200000 846 
	892022400000 847 
	892029600000 848 
	892044000000 849 
	892065600000 850 
	892098000000 851 
	892123200000 852 
	892137600000 853 
	892162800000 854 
	892238400000 855 
	892242000000 856 
	892310400000 857 
	892346400000 858 
	892350000000 859 
	892465200000 860 
	892479600000 861 
	892512000000 862 
	892594800000 863 
	892641600000 864 
	892659600000 865 
	892760400000 866 
	892767600000 867 
	892832400000 868 
	892857600000 869 
	892918800000 870 
	892954800000 871 
	893023200000 872 
	893026800000 873 
	893052000000 874 
	893084400000 875 
	893091600000 876 
	893142000000 877 
	893145600000 878 
	893217600000 879 
	893242800000 880 
	893271600000 881 
	893311200000 882 
	893368800000 883 
	893401200000 884 
	893487600000 885 
	893512800000 886 
	893559600000 887 
	893595600000 888 
	893700000000 889 
	893728800000 890 
	893746800000 891 
	893750400000 892 
	893764800000 893 
	893811600000 894 
	893919600000 895 
	893952000000 896 
	893980800000 897 
	894110400000 898 
	894207600000 899 
	894283200000 900 
	894290400000 901 
	894294000000 902 
	894308400000 903 
	894315600000 904 
	894405600000 905 
	894456000000 906 
	894477600000 907 
	894520800000 908 
	894531600000 909 
	894553200000 910 
	894578400000 911 
	894589200000 912 
	894592800000 913 
	894600000000 914 
	894643200000 915 
	894690000000 916 
	894726000000 917 
	894729600000 918 
	894736800000 919 
	894744000000 920 
	894783600000 921 
	894790800000 922 
	894855600000 923 
	894859200000 924 
	894870000000 925 
	894877200000 926 
	894891600000 927 
	894916800000 928 
	894920400000 929 
	894945600000 930 
	894970800000 931 
	895003200000 932 
	895014000000 933 
	895035600000 934 
	895118400000 935 
	895125600000 936 
	895140000000 937 
	895168800000 938 
	895172400000 939 
	895204800000 940 
	895240800000 941 
	895366800000 942 
	895395600000 943 
	895438800000 944 
	895478400000 945 
	895510800000 946 
	895518000000 947 
	query
	864955600000 867261200000
	870971200000 873579200000
	870298000000 875102000000
	877508800000 884091200000
	867918400000 868906400000
	876068800000 882827600000
	872512000000 885646400000
	864329200000 868888400000
	869084800000 875706800000
	874787200000 889826000000
	878887600000 893919200000
	865546000000 874137200000
	867583600000 872578400000
	877703200000 882237200000
	878149600000 889703600000
	868663600000 877672400000
	871446400000 871761200000
	873826000000 873842000000
	876562000000 879422000000
	877764400000 885056000000
	870510400000 876984800000
	878048800000 880653200000
	864016000000 868726400000
	874952800000 880372400000
	867101200000 867362000000
	866467600000 879105200000
	866935600000 874972400000
	872746000000 884706800000
	873883600000 878518400000
	872692000000 881186000000
	873325600000 877550000000
	875154400000 882428000000
	871025200000 872060000000
	875582800000 890456000000
	876313600000 890045600000
	868764400000 872153600000
	876547600000 880966400000
	869747200000 873615200000
	876655600000 888695600000
	874376800000 881340800000
	877537600000 885380000000
	867565600000 874475600000
	877753600000 891500000000
	873055600000 886046000000
	878606800000 890643200000
	869254000000 884519600000
	879128800000 890909600000
	865787200000 868982000000
	870510400000 882888800000
	872951200000 880685600000
	878329600000 887158400000
	872728000000 878594000000
	872710000000 881582000000
	874690000000 881229200000
	879312400000 882852800000
	871050400000 880772000000
	876551200000 890625200000
	874992400000 878280800000
	877807600000 880862000000
	879449200000 880862000000
	866453200000 872729600000
	865603600000 876434000000
	876968800000 888087200000
	865081600000 871080800000
	864001600000 864017600000
	868328800000 880264400000
	864354400000 872499200000
	878110000000 891777200000
	864937600000 880588400000
	865420000000 870796400000
	874481200000 881031200000
	876742000000 887820800000
	874060000000 875854400000
	874826800000 881942000000
	870942400000 871494800000
	876558400000 885005600000
	868627600000 873442400000
	875752000000 885837200000
	864019600000 876117200000
	879197200000 884022800000
	871615600000 872247200000
	877195600000 881812400000
	879506800000 892137200000
	875086000000 886434800000
	878707600000 884890400000
	874373200000 882208400000
	871450000000 880574000000
	872044000000 875958800000
	875539600000 879627200000
	867475600000 874508000000
	864656800000 867776000000
	873905200000 885718400000
	870445600000 876678800000
	868901200000 878550800000
	875654800000 884328800000
	879193600000 880095200000
	871712800000 874263200000
	876385600000 878846000000
	874376800000 877989200000
	879222400000 881466800000
	868620400000 871192400000
	872198800000 876866000000
	879157600000 886920800000
	870470800000 881243600000
	879362800000 882046400000
	865222000000 874828400000
	871828000000 884656400000
	868462000000 870882800000
	864844000000 880570400000
	870481600000 878205200000
	869930800000 882716000000
	867068800000 879184400000
	879028000000 882806000000
	866694400000 870375200000
	866424400000 875609600000
	864469600000 878478800000
	868469200000 868953200000
	870751600000 878223200000
	871471600000 883176800000
	876068800000 887604800000
	878020000000 881733200000
	877944400000 892785200000
	869102800000 879839600000
	874243600000 881884400000
	878243200000 889768400000
	877904800000 890013200000
	868256800000 881596400000
	866917600000 869597600000
	869052400000 879962000000
	876338800000 889149200000
	868789600000 869936000000
	873570400000 887100800000
	877166800000 877748000000
	872346400000 883763600000
	866784400000 870699200000
	876562000000 877784000000
	879089200000 886150400000
	871266400000 882644000000
	869585200000 883000400000
	876976000000 885153200000
	874236400000 884030000000
	874880800000 879756800000
	879298000000 881531600000
	872710000000 878687600000
	864026800000 874472000000
	873750400000 880088000000
	870337600000 871131200000
	864318400000 879274400000
	874790800000 887136800000
	870280000000 879440000000
	869639200000 870227600000
	871921600000 876354800000
	867061600000 878252000000
	870517600000 877708400000
	873340000000 880678400000
	871572400000 872366000000
	866201200000 873593600000
	865405600000 870972800000
	874099600000 878388800000
	878855200000 893667200000
	865204000000 872319200000
	873541600000 886211600000
	866989600000 882284000000
	875158000000 877654400000
	874085200000 888641600000
	869045200000 877776800000
	879373600000 883605200000
	875384800000 890240000000
	879485200000 885614000000
	879463600000 880606400000
	869113600000 882413600000
	872000800000 873888800000
	876166000000 883533200000
	864440800000 876646400000
	875539600000 876318800000
	867400000000 869147600000
	867904000000 870972800000
	872944000000 879767600000
	865405600000 874857200000
	879319600000 894124400000
	865524400000 879832400000
	876950800000 884987600000
	871144000000 879137600000
	871086400000 872916800000
	866305600000 868244000000
	866028400000 871826000000
	871576000000 884480000000
	877789600000 885524000000
	866086000000 867218000000
	876727600000 886053200000
	878275600000 892842800000
	878034400000 884508800000
	864714400000 877280000000
	871057600000 885106400000
	874891600000 882518000000
	879467200000 892040000000
	876731200000 892112000000
	871151200000 876023600000
	875550400000 879490400000
	870247600000 885678800000

 */

public class SchedulerTest {
	
	public static void main(String[] args) {
		Scanner jin = new Scanner(System.in);
		int k = jin.nextInt();
		if ( k == 0 ) {
			Scheduler<String> scheduler = new Scheduler<String>();
			Date now = new Date();
			scheduler.add(new Date(now.getTime()-7200000), jin.next());
			scheduler.add(new Date(now.getTime()-3600000), jin.next());
			scheduler.add(new Date(now.getTime()-14400000), jin.next());
			scheduler.add(new Date(now.getTime()+7200000), jin.next());
			scheduler.add(new Date(now.getTime()+14400000), jin.next());
			scheduler.add(new Date(now.getTime()+3600000), jin.next());
			scheduler.add(new Date(now.getTime()+18000000), jin.next());
			System.out.println(scheduler.getFirst());
			System.out.println(scheduler.getLast());
		}
		if ( k == 3 ) { //test Scheduler with String
			Scheduler<String> scheduler = new Scheduler<String>();
			Date now = new Date();
			scheduler.add(new Date(now.getTime()-7200000), jin.next());
			scheduler.add(new Date(now.getTime()-3600000), jin.next());
			scheduler.add(new Date(now.getTime()-14400000), jin.next());
			scheduler.add(new Date(now.getTime()+7200000), jin.next());
			scheduler.add(new Date(now.getTime()+14400000), jin.next());
			scheduler.add(new Date(now.getTime()+3600000), jin.next());
			scheduler.add(new Date(now.getTime()+18000000), jin.next());
			System.out.println(scheduler.next());
			System.out.println(scheduler.last());
			ArrayList<String> res = scheduler.getAll(new Date(now.getTime()-10000000), new Date(now.getTime()+17000000));
			Collections.sort(res);
			for ( String t : res ) {
				System.out.print(t+" , ");
			}
		}
		if ( k == 4 ) {//test Scheduler with ints complex
			Scheduler<Integer> scheduler = new Scheduler<Integer>();
			int counter = 0;
			ArrayList<Date> to_remove = new ArrayList<Date>();
			
			while ( jin.hasNextLong() ) {
				Date d = new Date(jin.nextLong());
				int i = jin.nextInt();
				if ( (counter&7) == 0 ) {
					to_remove.add(d);
				}
				scheduler.add(d,i);
				++counter;
			}
			jin.next();
			
			while ( jin.hasNextLong() ) {
				Date l = new Date(jin.nextLong());
				Date h = new Date(jin.nextLong());
				ArrayList<Integer> res = scheduler.getAll(l,h);
				Collections.sort(res);
				System.out.println(l+" <: "+print(res)+" >: "+h);
			}
			System.out.println("test");
			ArrayList<Integer> res = scheduler.getAll(new Date(0),new Date(Long.MAX_VALUE));
			Collections.sort(res);
			System.out.println(print(res));
			for ( Date d : to_remove ) {
				scheduler.remove(d);
			}
			res = scheduler.getAll(new Date(0),new Date(Long.MAX_VALUE));
			Collections.sort(res);
			System.out.println(print(res));
		}
	}

	private static <T> String print(ArrayList<T> res) {
		if ( res == null || res.size() == 0 ) return "NONE";
		StringBuffer sb = new StringBuffer();
		for ( T t : res ) {
			sb.append(t+" , ");
		}
		return sb.substring(0, sb.length()-3);
	}

}
